**DNSx - DNS Resolution & Validation**
Purpose: Resolve subdomains to IPs, validate DNS records, filter wildcards.

**Entry Decision**

| **IF:** Have subdomain list AND need IP resolution<br><br>**THEN:** Use DNSx to resolve and validate |
| :--------------------------------------------------------------------------------------------------- |

**Record Type Selection**

| **Condition**               | **Action / Command**                     |
| :-------------------------- | :--------------------------------------- |
| Need IPs only               | dnsx -l subs.txt -a -silent              |
| Need all record types       | dnsx -l subs.txt -a -aaaa -cname -ns -mx |
| Check for CNAMEs (takeover) | dnsx -l subs.txt -cname -resp-only       |
| Reverse lookup (PTR)        | dnsx -l ips.txt -ptr                     |
| Find mail servers           | dnsx -l subs.txt -mx -resp-only          |

**Filtering Decisions**

| **Condition**         | **Action / Command**                            |
| :-------------------- | :---------------------------------------------- |
| Filter wildcards      | dnsx -l subs.txt -a -wildcard                   |
| Filter by IP          | dnsx -l subs.txt -a -resp '1.2.3.4'             |
| Filter by regex       | dnsx -l subs.txt -a -resp-regex '^10.'          |
| CDN detection (CNAME) | dnsx -l subs.txt -cname -resp-regex 'cloudfront |

**Performance Tuning**

| **Condition**     | **Action / Command**                          |
| :---------------- | :-------------------------------------------- |
| Default scan      | dnsx -l subs.txt -a -c 100                    |
| Large list (>10K) | dnsx -l subs.txt -a -c 200 -stream            |
| Resolver issues   | dnsx -l subs.txt -a -resolver 1.1.1.1,8.8.8.8 |
| Rate limited      | dnsx -l subs.txt -a -rate-limit 50            |

**Pipeline Integration**

# Standard flow

subfinder -d $TARGET -silent | dnsx -a -silent | httpx -silent

# With CNAME check for takeover candidates

dnsx -l subs.txt -cname -resp-only | grep -E 'github|s3|azure'