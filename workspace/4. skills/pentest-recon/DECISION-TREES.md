# Reconnaissance Decision Trees

**Purpose**: Decision layer for tool selection and execution strategy.  
**Knowledge Base(KB)**: Reference individual tool .md files for detailed syntax and options.  

---

# Table of Contents

1. [Master Workflow](#1-master-workflow)
2. [Subfinder Decisions](#2-subfinder---subdomain-enumeration)
3. [Amass Decisions](#3-amass---advanced-dns-enumeration)
4. [DNSx Decisions](#4-dnsx---dns-resolution--validation)
5. [Naabu Decisions](#5-naabu---fast-port-scanning)
6. [Nmap Decisions](#6-nmap---advanced-port--service-scanning)
7. [HTTPX Decisions](#7-httpx---http-probing--technology-detection)
8. [Katana Decisions](#8-katana---web-crawling)
9. [Gobuster Decisions](#9-gobuster---directory-brute-forcing)
10. [FFUF Decisions](#10-ffuf---flexible-fuzzing)
11. [WhatWeb Decisions](#11-whatweb---technology-fingerprinting)
12. [Nuclei Decisions](#12-nuclei---vulnerability-scanning)
13. [Nikto Decisions](#13-nikto---web-server-scanning)
14. [Quick Reference](#14-quick-reference)

---

# 1. Master Workflow

## Primary Decision Flow

```
                              ┌─────────────────────┐
                              │   TARGET RECEIVED   │
                              └──────────┬──────────┘
                                         │
                              ┌──────────▼──────────┐
                              │  In TARGETS.md?     │
                              └──────────┬──────────┘
                                         │
                     ┌───────────────────┴───────────────────┐
                     ▼                                       ▼
              ┌─────────┐                             ┌─────────────┐
              │   YES   │                             │     NO      │
              └────┬────┘                             └──────┬──────┘
                   │                                         │
                   ▼                                         ▼
          ┌────────────────┐                       ┌─────────────────┐
          │ Continue Recon │                       │ STOP & NOTIFY   │
          └───────┬────────┘                       │ OPERATOR        │
                  │                                └─────────────────┘
                  ▼
       ┌─────────────────────┐
       │  Target Type?       │
       └──────────┬──────────┘
                  │
       ┌──────────┴──────────┐
       ▼                     ▼
   ┌────────┐           ┌────────┐
   │ DOMAIN │           │   IP   │
   └───┬────┘           └───┬────┘
       │                    │
       ▼                    │
┌──────────────┐            │
│ Phase 2:     │            │
│ Subdomain    │            │
│ Enumeration  │            │
│              │            │
│ ┌──────────┐ │            │
│ │subfinder │ │            │
│ │   ↓      │ │            │
│ │ amass    │ │            │
│ │   ↓      │ │            │
│ │ dnsx     │ │            │
│ └──────────┘ │            │
└──────┬───────┘            │
       │                    │
       ▼                    │
┌──────────────┐◄───────────┘
│ Phase 3:     │
│ Live Host    │
│ Discovery    │
│              │
│ ┌──────────┐ │
│ │  httpx   │ │
│ └──────────┘ │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ Phase 4:     │
│ Port Scan    │
│              │
│ ┌──────────┐ │
│ │ naabu    │ │
│ │   ↓      │ │
│ │ nmap     │ │
│ └──────────┘ │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ Phase 5:     │
│ Fingerprint  │
│              │
│ ┌──────────┐ │
│ │ whatweb  │ │
│ │ wafw00f  │ │
│ │ sslscan  │ │
│ └──────────┘ │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ Phase 6:     │
│ URL & Path   │
│ Discovery    │
│              │
│ ┌──────────┐ │
│ │waybackurl│ │
│ │ gau      │ │
│ │ katana   │ │
│ │ gobuster │ │
│ │ ffuf     │ │
│ └──────────┘ │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ Phase 7:     │──────┐
│ Vuln Scan    │      │
│              │      ▼
│ ┌──────────┐ │  ┌─────────────────────────┐
│ │ nuclei   │ │  │ CRITICAL/HIGH finding?  │
│ │ nikto    │ │  │                         │
│ └──────────┘ │  │ YES → Notify IMMEDIATELY│
└──────┬───────┘  │       Don't wait for    │
       │          │       phase completion  │
       │          └─────────────────────────┘
       ▼
┌──────────────┐
│ Phase 8-9:   │
│ Report &     │
│ Notify       │
└──────────────┘
```

## Time Budget Decision

```
What's the time budget?
│
├─► < 30 minutes
│   └─► Quick scan: subfinder | httpx | nuclei -tags tech
│       Phases: 2, 3, 7 (partial)
│
├─► < 2 hours  
│   └─► Standard scan: Full passive + core active
│       Phases: 1, 2, 3, 4, 7
│
└─► 5+ hours
    └─► Comprehensive: Full 9-phase methodology
        All phases with multi-wordlist approach
```

## Stealth Level Decision

```
What stealth level is required?
│
├─► Maximum Stealth (no target contact)
│   └─► Tools: subfinder, amass -passive, waybackurls, gau
│   └─► Skip: Active scanning, port scanning, fuzzing
│
├─► Low Noise (minimal footprint)
│   └─► Tools: + httpx, katana -depth 1, dnsx
│   └─► Settings: Low concurrency, delays between requests
│
├─► Normal (standard pentest)
│   └─► Tools: + naabu, gobuster -t 10, nuclei
│   └─► Settings: Default concurrency
│
└─► Aggressive (speed priority, no stealth)
    └─► Tools: + nmap -A, nikto, gobuster -t 50
    └─► Settings: High concurrency, no delays
```

---

# 2. SUBFINDER - Subdomain Enumeration

> **KB Reference**: `subfinder.md`

## When to Use

```
┌─────────────────────────────────────────────────────────────┐
│ TARGET is a DOMAIN (not IP)?                                │
│ └─► YES → Start with Subfinder (passive, fast, first tool)  │
│ └─► NO  → Skip to Phase 3/4 (httpx or port scanning)        │
└─────────────────────────────────────────────────────────────┘
```

## Mode Decision Tree

```
                    ┌──────────────────┐
                    │  SUBFINDER       │
                    │  Mode Selection  │
                    └────────┬─────────┘
                             │
         ┌───────────────────┼───────────────────┐
         │                   │                   │
         ▼                   ▼                   ▼
   ┌───────────┐      ┌───────────┐      ┌───────────┐
   │  STEALTH  │      │   SPEED   │      │  THOROUGH │
   │ Priority  │      │ Priority  │      │  Priority │
   └─────┬─────┘      └─────┬─────┘      └─────┬─────┘
         │                  │                  │
         ▼                  ▼                  ▼
    -silent            -all -sc 50        -all -recursive
    (passive only)     -hc 50             -max-depth 2
                       (fast parallel)    (find sub-subs)
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Stealth required | Passive only | `-silent` |
| Speed priority | High concurrency | `-all -sc 50 -hc 50` |
| Comprehensive | Recursive + all sources | `-all -recursive` |
| Multiple targets | List input | `-dL domains.txt` |
| API keys configured | Use all sources | `-all` |
| Being rate-limited | Reduce speed | `-sc 5 -delay 2` |
| Low memory | Process one by one | Loop with single `-d` |

## Output Decision

| Next Tool | Pipeline |
|-----------|----------|
| → DNSx | `subfinder ... -silent \| dnsx -a -silent` |
| → HTTPX | `subfinder ... -silent \| httpx -silent` |
| → Naabu | `subfinder ... -silent \| naabu -silent` |
| → File | `subfinder ... -o $SCANDIR/subs.txt` |

## Critical Rules

- **ALWAYS** combine with Amass for completeness
- **ALWAYS** add `-nW` to remove wildcards
- **ALWAYS** dedupe with `sort -u` before next tool

---

# 3. AMASS - Advanced DNS Enumeration

> **KB Reference**: `amass.md`

## When to Use: Amass vs Subfinder

```
┌─────────────────────────────────────────────────────────────┐
│ Quick scan (< 5 min)?                                       │
│ └─► Subfinder ONLY                                          │
├─────────────────────────────────────────────────────────────┤
│ Comprehensive enumeration?                                  │
│ └─► BOTH Subfinder AND Amass (merge results)                │
├─────────────────────────────────────────────────────────────┤
│ Need org intelligence (ASN, CIDR, related domains)?         │
│ └─► Amass INTEL mode                                        │
├─────────────────────────────────────────────────────────────┤
│ BEST PRACTICE: Use both, always merge                       │
└─────────────────────────────────────────────────────────────┘
```

## Mode Decision Tree

```
                    ┌──────────────────┐
                    │      AMASS       │
                    │  Mode Selection  │
                    └────────┬─────────┘
                             │
         ┌───────────────────┼───────────────────┐
         │                   │                   │
         ▼                   ▼                   ▼
   ┌───────────┐      ┌───────────┐      ┌───────────┐
   │   ENUM    │      │   ENUM    │      │   INTEL   │
   │  Passive  │      │  Active   │      │  Gather   │
   └─────┬─────┘      └─────┬─────┘      └─────┬─────┘
         │                  │                  │
         ▼                  ▼                  ▼
   amass enum          amass enum         amass intel
   -passive            -active -brute     -org "Name"
   -d $TARGET          -d $TARGET         -asn XXXXX
```

## Decision Matrix

| Scenario | Decision | Mode |
|----------|----------|------|
| Stealth required | Passive only | `enum -passive` |
| Standard recon | Active enum | `enum -active` |
| Need more subs | Add brute force | `enum -active -brute` |
| Org research | Intel gathering | `intel -org "Name"` |
| Know ASN | ASN enumeration | `intel -asn 12345` |
| Slow network | Reduce queries | `-max-dns-queries 500` |
| Fast network | Increase queries | `-max-dns-queries 2000` |

---

# 4. DNSx - DNS Resolution & Validation

> **KB Reference**: `dnsx.md`

## When to Use

```
┌─────────────────────────────────────────────────────────────┐
│ Have subdomain list AND need:                               │
│ • IP resolution?           → dnsx -a                        │
│ • CNAME (takeover check)?  → dnsx -cname                    │
│ • Wildcard filtering?      → dnsx -wildcard                 │
│ • Multiple record types?   → dnsx -a -aaaa -cname -mx       │
└─────────────────────────────────────────────────────────────┘
```

## Record Type Decision Tree

```
                    ┌──────────────────┐
                    │      DNSx        │
                    │  Record Types    │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌───────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │   A   │ │ CNAME │  │  MX   │  │  NS   │  │  ALL  │
  │ (IP)  │ │(Alias)│  │(Mail) │  │(Name) │  │       │
  └───┬───┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
     -a      -cname       -mx        -ns     -a -aaaa
  (default)  (takeover)  (mail)    (DNS)    -cname -mx
                                            -ns
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Standard resolution | A records | `-a -silent` |
| Include IPv6 | Add AAAA | `-a -aaaa` |
| Takeover candidates | CNAME only | `-cname -resp-only` |
| Full DNS picture | All records | `-a -aaaa -cname -mx -ns` |
| Filter wildcards | Enable filter | `-wildcard` |
| Specific IP match | Response filter | `-resp '1.2.3.4'` |
| Large list | Stream mode | `-stream -c 200` |

## Takeover Detection Pattern

```bash
dnsx -l subs.txt -cname -resp-only | \
  grep -E "(github|s3|azure|heroku|cloudfront|shopify|fastly)" \
  > takeover-candidates.txt
```

---

# 5. NAABU - Fast Port Scanning

> **KB Reference**: `naabu.md`

## Naabu vs Nmap Decision

```
┌─────────────────────────────────────────────────────────────┐
│ Need QUICK port discovery for pipeline?                     │
│ └─► NAABU (fast, integrates well)                           │
├─────────────────────────────────────────────────────────────┤
│ Need DETAILED service enumeration?                          │
│ └─► NMAP (after Naabu finds open ports)                     │
├─────────────────────────────────────────────────────────────┤
│ BEST PRACTICE: Naabu (discovery) → Nmap (details)           │
└─────────────────────────────────────────────────────────────┘
```

## Permission Decision

```
┌─────────────────────────────────────────────────────────────┐
│ Have ROOT / SUDO access?                                    │
│ └─► YES → SYN scan: sudo naabu -scan-type s                 │
│           (faster, stealthier)                              │
│ └─► NO  → CONNECT scan: naabu -scan-type c                  │
│           (works without root, slower)                      │
└─────────────────────────────────────────────────────────────┘
```

## Scan Type Decision Tree

```
                    ┌──────────────────┐
                    │      NAABU       │
                    │   Scan Type      │
                    └────────┬─────────┘
                             │
         ┌───────────────────┼───────────────────┐
         │                   │                   │
         ▼                   ▼                   ▼
   ┌───────────┐      ┌───────────┐      ┌───────────┐
   │   QUICK   │      │  STANDARD │      │   FULL    │
   │ Web Ports │      │  Top 100  │      │ All Ports │
   └─────┬─────┘      └─────┬─────┘      └─────┬─────┘
         │                  │                  │
         ▼                  ▼                  ▼
   -p 80,443,          -top-ports 100       -p -
   8080,8443           (common)             (65535)
   (2 min)             (5-10 min)           (30+ min)
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Quick web check | Common web ports | `-p 80,443,8080,8443` |
| Standard scan | Top 100 | `-top-ports 100` |
| Thorough | Top 1000 | `-top-ports 1000` |
| Complete | All ports | `-p -` |
| Have root | SYN scan | `sudo ... -scan-type s` |
| No root | Connect scan | `-scan-type c` |
| UDP needed | UDP scan | `sudo ... -scan-type u` |
| Skip CDN | Exclude CDN | `-exclude-cdn` |
| Fast network | High rate | `-rate 5000 -c 100` |
| IDS evasion | Low rate + random | `-rate 50 -scan-random-port` |

---

# 6. NMAP - Advanced Port & Service Scanning

> **KB Reference**: `nmap.md`

## When to Use Nmap

```
┌─────────────────────────────────────────────────────────────┐
│ After Naabu identifies open ports, use Nmap for:            │
│ • Service version detection     → -sV                       │
│ • OS fingerprinting             → -O                        │
│ • Default script scanning       → -sC                       │
│ • Vulnerability scripts         → --script vuln             │
│ • Comprehensive scan            → -A                        │
└─────────────────────────────────────────────────────────────┘
```

## Scan Type Decision Tree

```
                    ┌──────────────────┐
                    │       NMAP       │
                    │    Scan Type     │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌───────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │ QUICK │ │VERSION│  │SCRIPTS│  │  FULL │  │STEALTH│
  │       │ │       │  │       │  │ (-A)  │  │       │
  └───┬───┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
   -T4 -F     -sV        -sC      -A         -sS -T2
  (fast)   (versions)  (default  (all)     (stealth)
                        scripts)
```

## Timing Decision

```
Stealth requirement?
│
├─► Maximum stealth  → -T0 or -T1 (very slow)
├─► Low noise        → -T2 (polite)
├─► Normal           → -T3 (default)
├─► Fast             → -T4 (aggressive)
└─► Maximum speed    → -T5 (may miss ports)
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Quick scan | Fast, few ports | `-T4 -F` |
| Version detection | Service versions | `-sV` |
| With scripts | Default NSE | `-sC` |
| Version + scripts | Combined | `-sV -sC` |
| Full enumeration | Aggressive | `-A` |
| Stealth needed | SYN + slow | `-sS -T2` |
| UDP services | UDP scan | `-sU` |
| Vuln check | Vuln scripts | `--script vuln` |
| All ports | Full range | `-p-` |

## Firewall Evasion Decision

```
Firewall/IDS detected?
│
├─► Fragment packets      → -f
├─► Use decoys            → -D RND:10
├─► Spoof source port     → --source-port 53
├─► Randomize order       → --randomize-hosts
├─► Add random data       → --data-length 25
└─► Combine techniques    → -f -D RND:5 --data-length 25
```

---

# 7. HTTPX - HTTP Probing & Technology Detection

> **KB Reference**: `httpx.md`

## When to Use

```
┌─────────────────────────────────────────────────────────────┐
│ Have list of hosts/subdomains/IPs?                          │
│ └─► HTTPX identifies which have live web services           │
│                                                             │
│ This is the BRIDGE between discovery and vulnerability scan │
└─────────────────────────────────────────────────────────────┘
```

## Information Level Decision Tree

```
                    ┌──────────────────┐
                    │      HTTPX       │
                    │  Output Level    │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌───────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │ BASIC │ │STATUS │  │ TECH  │  │ FULL  │  │SCREEN │
  │ Probe │ │+Title │  │Detect │  │ Meta  │  │ Shot  │
  └───┬───┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
  -silent   -status-    -tech-    -status-   -screenshot
  (URLs     code        detect    code
   only)    -title               -title
                                 -tech-detect
                                 -server
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Pipeline (URLs only) | Basic | `-silent` |
| Quick status check | Status + title | `-status-code -title` |
| Technology focus | Tech detection | `-tech-detect` |
| Full metadata | All info | `-status-code -title -tech-detect -server` |
| Visual evidence | Screenshots | `-screenshot` |
| Filter success | Only 200 | `-mc 200` |
| Skip errors | Hide 404/403 | `-fc 404,403` |
| Match tech | Specific tech | `-tech-detect -match-tech wordpress` |
| Custom ports | Non-standard | `-ports 80,443,8080,8443,9000` |
| Large list | Streaming | `-stream -c 100` |
| Rate limited | Slow down | `-c 10 -timeout 15 -delay 2s` |

---

# 8. KATANA - Web Crawling

> **KB Reference**: `katana.md`

## Katana vs Gobuster/FFUF Decision

```
┌─────────────────────────────────────────────────────────────┐
│ Need to DISCOVER endpoints via crawling (follows links)?    │
│ └─► KATANA                                                  │
├─────────────────────────────────────────────────────────────┤
│ Need to BRUTE-FORCE directories (wordlist-based)?           │
│ └─► GOBUSTER or FFUF                                        │
├─────────────────────────────────────────────────────────────┤
│ BEST PRACTICE:                                              │
│ Passive (wayback/gau) → Katana (crawl) → Gobuster (brute)   │
└─────────────────────────────────────────────────────────────┘
```

## Crawler Mode Decision Tree

```
                    ┌──────────────────┐
                    │     KATANA       │
                    │  Crawler Mode    │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌───────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │STANDARD│ │  JS   │  │SITEMAP│  │ROBOTS │  │  ALL  │
  │ HTTP  │ │ Parse │  │ Based │  │ Based │  │       │
  └───┬───┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
  -crawler   -js-crawl  -crawler   -crawler   -crawler
  standard   (headless) sitemap    robots     standard,js,
                                              sitemap,robots
```

## Depth Decision

```
Time budget?
│
├─► Quick (< 5 min)     → -depth 1 (surface only)
├─► Standard (10 min)   → -depth 2 (default)
├─► Thorough (20+ min)  → -depth 3-5 (deep crawl)
└─► Maximum             → -depth 5+ -js-crawl (comprehensive)
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Quick crawl | Shallow | `-depth 1` |
| Standard | Default depth | `-depth 2` |
| Deep crawl | More depth | `-depth 5` |
| JS-heavy site | Headless | `-js-crawl` |
| Find sitemap entries | Sitemap mode | `-crawler sitemap` |
| All methods | Combined | `-crawler standard,js,sitemap,robots` |
| Same domain only | Strict scope | `-crawl-scope strict` |
| Include subdomains | Wider scope | `-crawl-scope subs` |
| JS files only | Extension filter | `-extension js` |
| Skip images | Exclude | `-exclude-extension png,jpg,gif,css` |
| Rate limited | Slow down | `-concurrency 5 -delay 500` |

---

# 9. GOBUSTER - Directory Brute-forcing

> **KB Reference**: `gobuster.md`

## Mode Decision Tree

```
                    ┌──────────────────┐
                    │    GOBUSTER      │
                    │      Mode        │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌───────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │  DIR  │ │  DNS  │  │ VHOST │  │  S3   │  │ FUZZ  │
  │ Mode  │ │ Mode  │  │ Mode  │  │Buckets│  │ Mode  │
  └───┬───┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
  gobuster   gobuster   gobuster   gobuster   gobuster
  dir        dns        vhost      s3         fuzz
```

## Wordlist Strategy (CRITICAL)

```
┌─────────────────────────────────────────────────────────────┐
│ BALANCED MULTI-WORDLIST APPROACH                            │
│                                                             │
│ Directories:                                                │
│  common.txt (~5K)        → ALWAYS run (2-3 min)             │
│  medium.txt (~220K)      → Standard scan (15-20 min)        │
│  big.txt (500K+)         → AVOID (diminishing returns)      │
│                                                             │
│ Decision:                                                   │
│  Time < 10 min?  → common.txt only                          │
│  Time < 30 min?  → common.txt + medium.txt                  │
│  Time > 30 min?  → Add extensions + API wordlists           │
│                                                             │
│ NEVER start with big.txt - always escalate from smaller     │
└─────────────────────────────────────────────────────────────┘
```

## Extension Decision

```
What technology detected? (from Phase 5)
│
├─► PHP           → -x php,php5,phtml,inc
├─► ASP.NET       → -x asp,aspx,ashx,asmx,config
├─► Java          → -x jsp,jsf,do,action,java
├─► Python        → -x py
├─► Backup files  → -x bak,old,backup,~,swp,orig
├─► Config files  → -x xml,conf,config,ini,env,yaml,yml
└─► Unknown       → -x php,asp,aspx,jsp,html,txt
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Quick baseline | Common wordlist | `-w common.txt` |
| Standard scan | Medium wordlist | `-w directory-list-2.3-medium.txt` |
| PHP app | PHP extensions | `-x php,phtml` |
| ASP.NET app | ASP extensions | `-x asp,aspx,ashx` |
| Find backups | Backup extensions | `-x bak,old,backup,~` |
| Hide 404 | Filter status | `-b 404` |
| Hide 403+404 | Filter both | `-b 404,403` |
| Faster | More threads | `-t 50` |
| Rate limited | Fewer threads + delay | `-t 5 --delay 100ms` |
| Follow redirects | Enable redirects | `-r` |

---

# 10. FFUF - Flexible Fuzzing

> **KB Reference**: `ffuf.md`

## FFUF vs Gobuster Decision

```
┌─────────────────────────────────────────────────────────────┐
│ Simple directory brute-force?                               │
│ └─► GOBUSTER (simpler, slightly faster)                     │
├─────────────────────────────────────────────────────────────┤
│ Need parameter fuzzing?                                     │
│ └─► FFUF                                                    │
├─────────────────────────────────────────────────────────────┤
│ Need header fuzzing?                                        │
│ └─► FFUF                                                    │
├─────────────────────────────────────────────────────────────┤
│ Need POST data / JSON body fuzzing?                         │
│ └─► FFUF                                                    │
├─────────────────────────────────────────────────────────────┤
│ Need multiple fuzz positions?                               │
│ └─► FFUF                                                    │
└─────────────────────────────────────────────────────────────┘
```

## Fuzzing Mode Decision Tree

```
                    ┌──────────────────┐
                    │       FFUF       │
                    │   Fuzz Target    │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌───────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │  DIR  │ │ PARAM │  │ VALUE │  │HEADER │  │ POST  │
  │ Path  │ │ Name  │  │Fuzzing│  │Fuzzing│  │ Body  │
  └───┬───┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
  /FUZZ      ?FUZZ=x    ?id=FUZZ  -H "X:FUZZ" -d "x=FUZZ"
```

## Filtering Decision

```
Too many results / false positives?
│
├─► Same status code      → -fc [code] (filter code)
├─► Same response size    → -fs [size] (filter size)
├─► Same word count       → -fw [count] (filter words)
├─► Same line count       → -fl [count] (filter lines)
├─► Regex pattern         → -fr "pattern" (filter regex)
│
Match specific results only?
│
├─► Specific status codes → -mc 200,301,302,401,403
├─► Specific size range   → -ms [size]
├─► Specific pattern      → -mr "pattern"
```

## Decision Matrix

| Scenario | Decision | Syntax |
|----------|----------|--------|
| Directory fuzz | Path position | `-u https://target/FUZZ` |
| Parameter name | Query position | `-u https://target?FUZZ=test` |
| Parameter value | Value position | `-u https://target?id=FUZZ` |
| Header value | Header position | `-H 'X-Custom: FUZZ'` |
| POST data | Body position | `-X POST -d 'user=FUZZ'` |
| JSON body | JSON position | `-d '{"id":"FUZZ"}'` |
| Multi-position | Multiple FUZZ | `-w w1:FUZZ1 -w w2:FUZZ2` |
| Filter 404 | Filter code | `-fc 404` |
| Filter size | Filter bytes | `-fs 1234` |
| Match 200 only | Match code | `-mc 200` |
| Rate limited | Reduce speed | `-t 10 -rate 50` |

---

# 11. WHATWEB - Technology Fingerprinting

> **KB Reference**: `whatweb.md`

## Aggression Level Decision

```
                    ┌──────────────────┐
                    │     WHATWEB      │
                    │ Aggression Level │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌────────┐ ┌───────┐  ┌───────┐  ┌───────┐  ┌───────┐
  │ -a 1   │ │  -a 2 │  │  -a 3 │  │  -a 4 │  │PASSIVE│
  │STEALTHY│ │DEFAULT│  │AGGRES-│  │ HEAVY │  │ ONLY  │
  │        │ │       │  │ SIVE  │  │       │  │       │
  └───┬────┘ └───┬───┘  └───┬───┘  └───┬───┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
  1 request   Few       Multiple   Many       Use httpx
  (passive)   requests  requests   requests   -tech-detect
                                   (noisy)    instead
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Stealth required | Level 1 | `-a 1` |
| Standard scan | Level 2 (default) | `-a 2` or none |
| Need more detail | Level 3 | `-a 3` |
| Maximum info | Level 4 (noisy) | `-a 4` |
| From file | List input | `-i urls.txt` |
| JSON output | Machine readable | `--log-json output.json` |
| Brief output | One line per host | `--log-brief output.txt` |

---

# 12. NUCLEI - Vulnerability Scanning

> **KB Reference**: `nuclei.md`

## When to Use

```
┌─────────────────────────────────────────────────────────────┐
│ Have list of live HTTP endpoints?                           │
│ └─► Nuclei is the PRIMARY vulnerability scanner             │
│                                                             │
│ First scan of target?                                       │
│ └─► Start with discovery/tech templates, then escalate      │
│                                                             │
│ Have technology fingerprint from Phase 5?                   │
│ └─► Use technology-specific templates                       │
└─────────────────────────────────────────────────────────────┘
```

## Template Selection Decision Tree

```
                    ┌──────────────────┐
                    │     NUCLEI       │
                    │ Template Select  │
                    └────────┬─────────┘
                             │
      ┌──────────┬───────────┼───────────┬──────────┐
      │          │           │           │          │
      ▼          ▼           ▼           ▼          ▼
  ┌────────┐ ┌───────┐  ┌─────────┐  ┌────────┐  ┌───────┐
  │DISCOVER│ │  CVE  │  │MISCONFIG|  │  TECH  │  │ FULL  │
  │        │ │       │  │         │  │SPECIFIC│  │       │
  └───┬────┘ └───┬───┘  └───┬─────┘  └───┬────┘  └───┬───┘
      │         │          │          │          │
      ▼         ▼          ▼          ▼          ▼
   -tags      -tags      -tags    -t tech/   -tags cve,
   tech,      cve        misconfig wordpress/ misconfig,
   exposure                       jira/      exposure
```

## Severity Decision

```
What findings to include?
│
├─► Critical only       → -severity critical
├─► High + Critical     → -severity high,critical (RECOMMENDED)
├─► Medium and above    → -severity medium,high,critical
├─► All findings        → (default, includes info/low)
├─► Exclude noise       → -exclude-severity info,low
```

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Initial discovery | Tech + exposure | `-tags tech,exposure` |
| CVE scanning | CVE templates | `-tags cve` |
| Misconfig check | Misconfig templates | `-tags misconfig` |
| Full security scan | Combined | `-tags cve,misconfig,exposure` |
| WordPress site | Tech-specific | `-t wordpress/` |
| Jira found | Tech-specific | `-t jira/` |
| Critical only | Filter severity | `-severity critical` |
| High impact | High + Critical | `-severity high,critical` |
| Skip noise | Exclude low | `-exclude-severity info,low` |
| Behind WAF | Slow + careful | `-c 10 -rate-limit 30` |
| Fast network | Aggressive | `-c 50 -rate-limit 300` |
| OOB testing | Interactsh | `-interactsh-server https://oast.me` |

## CRITICAL Finding Protocol

```
┌─────────────────────────────────────────────────────────────┐
│ CRITICAL or HIGH finding detected?                          │
│                                                             │
│ → Notify operator IMMEDIATELY via Telegram                  │
│ → Do NOT wait for phase completion                          │
│ → Format: "CRITICAL | [CVE] | [Host] | [Description]"       │
│ → Await operator instructions before proceeding             │
└─────────────────────────────────────────────────────────────┘
```

---

# 13. NIKTO - Web Server Scanning

> **KB Reference**: `nikto.md`

## When to Use

```
┌─────────────────────────────────────────────────────────────┐
│ Need comprehensive web server security check?               │
│ └─► NIKTO (thorough but slow and NOISY)                    │
├─────────────────────────────────────────────────────────────┤
│ Stealth required?                                           │
│ └─► AVOID Nikto - very noisy, easily detected by WAF/IDS  │
├─────────────────────────────────────────────────────────────┤
│ Nikto complements Nuclei:                                   │
│ • Nuclei = template-based, specific CVEs                   │
│ • Nikto = broad server checks, legacy issues               │
└─────────────────────────────────────────────────────────────┘
```

## Tuning Decision

```
What to check?
│
├─► Information only     → -Tuning 3
├─► Quick basics         → -Tuning 123 (info + files + misconfig)
├─► Standard scan        → -Tuning 123456789bc (skip DoS)
├─► Full scan            → -Tuning 123456789bcd
│
AVOID -Tuning 6 (DoS) - Can harm target
```

## Tuning Reference

| Code | Description | Risk |
|------|-------------|------|
| 1 | Interesting files | Low |
| 2 | Misconfiguration | Low |
| 3 | Information disclosure | Low |
| 4 | XSS/injection | Medium |
| 5 | Remote file retrieval | Medium |
| **6** | **DoS - AVOID** | **HIGH** |
| 7 | Remote shell | Medium |
| 8 | SQL injection | Medium |
| 9 | File upload | Medium |
| b | Software ID | Low |
| c | Remote source inclusion | Medium |
| d | WebService | Medium |

## Decision Matrix

| Scenario | Decision | Flags |
|----------|----------|-------|
| Quick scan | Basic checks | `-Tuning 123` |
| Standard | Skip DoS only | `-Tuning 123456789bcd` |
| Info only | Information | `-Tuning 3` |
| SSL focus | SSL checks | `-Tuning 7` |
| Time limited | Max time | `-maxtime 300` |
| Rate limited | Add pause | `-Pause 2` |
| Via proxy | Use proxy | `-useproxy http://127.0.0.1:8080` |
| HTML report | HTML format | `-o report.html -Format html` |

---

# 14. Quick Reference

## Tool Selection by Phase

| Phase | Primary | Secondary | Condition for Secondary |
|-------|---------|-----------|------------------------|
| 2. Subdomain | Subfinder | Amass | Always use both |
| 2. DNS Resolve | DNSx | - | Required step |
| 3. HTTP Probe | HTTPX | - | Required step |
| 4. Port Discovery | Naabu | - | Fast discovery |
| 4. Port Detail | Nmap | - | After Naabu |
| 5. Tech Fingerprint | WhatWeb | HTTPX -tech-detect | Use both |
| 5. WAF Detection | wafw00f | - | Always check |
| 6. Passive URLs | waybackurls, gau | - | Always first |
| 6. Active Crawl | Katana | - | After passive |
| 6. Dir Brute | Gobuster | FFUF | FFUF for param fuzz |
| 7. Vuln Scan | Nuclei | Nikto | Nikto if time permits |

## Time Budget Quick Guide

| Budget | Tools | Phases |
|--------|-------|--------|
| 15 min | subfinder → httpx → nuclei -tags tech | 2,3,7 |
| 30 min | + dnsx + naabu | 2,3,4,7 |
| 2 hours | + amass + nmap -sV + whatweb + katana | 1-5,7 |
| 5 hours | Full methodology with multi-wordlist | All 9 |

## Stealth Quick Guide

| Level | Avoid | Use |
|-------|-------|-----|
| Maximum | All active tools | subfinder, amass -passive, waybackurls |
| Low | nmap -A, nikto, fast scans | httpx, katana -depth 1, slow rates |
| Normal | nikto, aggressive nmap | Standard tools, default rates |
| None | - | Everything, high concurrency |

## Pipeline Quick Reference

```bash
# Quick recon (15 min)
subfinder -d $T -silent | httpx -silent | nuclei -tags tech

# Standard recon (30 min)
subfinder -d $T -silent | dnsx -a -silent | httpx -silent | nuclei -severity high,critical

# Full subdomain pipeline
subfinder -d $T -all -silent > s.txt; amass enum -passive -d $T >> s.txt
sort -u s.txt | dnsx -a -silent | httpx -status-code -title -tech-detect

# Path discovery pipeline
waybackurls $T > u.txt; gau $T >> u.txt; katana -u https://$T -silent >> u.txt
sort -u u.txt
```

---

**Note**: This file provides decision logic. For detailed command syntax and all available options, refer to individual tool knowledge base files (subfinder.md, amass.md, etc.)
