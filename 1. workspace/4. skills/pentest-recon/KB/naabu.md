**Naabu - Port scanning**
Purpose: Fast port scanning optimized for reconnaissance pipelines. Use for initial port discovery.

**Entry Decision**

| **IF:** Need quick port scan for web discovery<br><br>**THEN:** Use NAABU - fast, integrates well with httpx |
| :----------------------------------------------------------------------------------------------------------- |
| **IF:** Need detailed service enumeration<br><br>**THEN:** Use NMAP after naabu identifies open ports        |

**Scan Type Selection**

| **Condition**          | **Action / Command**                                |
| :--------------------- | :-------------------------------------------------- |
| Quick web ports        | naabu -host $TARGET -p 80,443,8080,8443 -silent     |
| Top 100 ports          | naabu -host $TARGET -top-ports 100 -silent          |
| Top 1000 ports         | naabu -host $TARGET -top-ports 1000                 |
| All ports (slow)       | naabu -host $TARGET -p - -rate 1000                 |
| UDP scan (root)        | sudo naabu -host $TARGET -scan-type u -p 53,161,500 |
| SYN scan (root)        | sudo naabu -host $TARGET -scan-type s               |
| Connect scan (no root) | naabu -host $TARGET -scan-type c                    |

**Permission-Based Decisions**

| **IF:** Running as root/sudo available<br><br>**THEN:** Use SYN scan (-scan-type s) for speed and stealth |
| :-------------------------------------------------------------------------------------------------------- |
| **IF:** No root access<br><br>**THEN:** Use CONNECT scan (-scan-type c) - slower but works                |

**Performance Tuning**

| **Condition** | **Action / Command**                           |
| :------------ | :--------------------------------------------- |
| Default       | naabu -host $TARGET -c 25 -rate 1000           |
| Fast network  | naabu -host $TARGET -c 100 -rate 5000          |
| Slow/filtered | naabu -host $TARGET -c 10 -rate 100 -retries 5 |
| IDS evasion   | naabu -host $TARGET -rate 50 -scan-random-port |

**Pipeline Commands**

# Subdomain to port to HTTP

subfinder -d $TARGET -silent | naabu -silent | httpx -silent

# Feed to nmap for service detection

naabu -host $TARGET -top-ports 100 -silent > ports.txt

nmap -iL ports.txt -sV -sC