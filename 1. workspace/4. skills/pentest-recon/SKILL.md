# Pentest Recon Skill
> **Location**: `workspace/skills/pentest-recon/SKILL.md`

## Skill Entity

```yaml
name: pentest-recon
version: 2.0
description: |
  State-of-the-art reconnaissance methodology with decision-tree-based tool selection.
  Comprehensive framework for external penetration testing reconnaissance.
  Includes 12 tool decision matrices and 9-phase execution workflow.
author: pho5nix
agent: EagleEye
updated: 2026-02-20

triggers:
  - recon, enumeration, subdomain discovery
  - port scanning, OSINT, fingerprinting
  - URL discovery, vulnerability scanning
  - target domain/IP received for pentest
  - "start recon", "begin reconnaissance", "run enumeration"
  - "scan target", "enumerate", "discover"

dependencies:
  - subfinder, amass, dnsx, httpx, naabu, nmap
  - katana, gobuster, ffuf, nuclei, nikto
  - whatweb, wafw00f, sslscan
  - theHarvester, dnsrecon, shodan, gau, waybackurls
```

---

## Critical: Pre-Flight Checklist

### Before ANY Reconnaissance

1. **â˜ Verify Scope**: Read `target/TARGETS.md` â€” if target not listed, **STOP** and notify operator
2. **â˜ Disable Unused Features**: Web search = OFF, Research = OFF during recon
3. **â˜ Check Session Budget**: Ensure sufficient time (phases 1-4: ~1hr, phases 5-7: ~2-3hr)
4. **â˜ Set Environment**:

```bash
export TARGET="example.com"
export DATE=$(date +%Y-%m-%d)
export SCANDIR="$HOME/workspace/scans/$TARGET"
export REPORTDIR="$HOME/workspace/reports"
mkdir -p $SCANDIR $REPORTDIR
START=$(date +%s)
echo "Recon initialized: $TARGET @ $(date)"
```

---

## Master Decision Tree

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   TARGET RECEIVED   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  In TARGETS.md?     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â–¼                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   YES   â”‚                   â”‚   NO    â”‚
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                   â”‚                              â”‚
                   â–¼                              â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Phase 1: OSINT â”‚              â”‚ STOP & NOTIFY  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   OPERATOR     â”‚
                  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Is target domain?  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  YES  â”‚            â”‚   NO   â”‚
   â”‚Domain â”‚            â”‚  (IP)  â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜            â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ Phase 2:     â”‚            â”‚
â”‚ Subdomains   â”‚            â”‚
â”‚ subfinder    â”‚            â”‚
â”‚ amass        â”‚            â”‚
â”‚ dnsx         â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ Phase 3:     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Live Hosts   â”‚
â”‚ httpx        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 4:     â”‚
â”‚ Port Scan    â”‚
â”‚ naabu â†’ nmap â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 5:     â”‚
â”‚ Fingerprint  â”‚
â”‚ whatweb      â”‚
â”‚ wafw00f      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 6:     â”‚
â”‚ URL/Path     â”‚
â”‚ katana       â”‚
â”‚ gobuster     â”‚
â”‚ ffuf         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 7:     â”‚â”€â”€â”€â”€â–ºâ”‚ CRITICAL/HIGH Finding?      â”‚
â”‚ Vuln Scan    â”‚     â”‚ â†’ IMMEDIATE Telegram notify â”‚
â”‚ nuclei       â”‚     â”‚ â†’ Do NOT wait for phase end â”‚
â”‚ nikto        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 8:     â”‚
â”‚ Report       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 9:     â”‚
â”‚ Notify       â”‚
â”‚ Operator     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# TOOL DECISION TREES

## 1. SUBFINDER â€” Subdomain Enumeration

**Purpose**: Fast passive subdomain discovery. First tool in the chain.

### Entry Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IF: Target is a domain AND subdomain enumeration needed     â”‚
â”‚ THEN: Start with Subfinder for passive enumeration          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mode Selection Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Start Subfinder â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                â–¼                â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Stealth   â”‚   â”‚   Speed    â”‚   â”‚Comprehensiveâ”‚
     â”‚  Priority? â”‚   â”‚  Priority? â”‚   â”‚   Needed?   â”‚
     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                 â”‚
           â–¼                â–¼                 â–¼
    subfinder -d      subfinder -d      subfinder -d
    $TARGET           $TARGET -all      $TARGET -all
    -silent           -sc 50 -hc 50     -recursive
```

### Decision Matrix

|Scenario|Command|Time|
|---|---|---|
|**Stealth required**|`subfinder -d $TARGET -silent`|2-3 min|
|**Speed priority**|`subfinder -d $TARGET -all -sc 50 -hc 50`|1-2 min|
|**Comprehensive**|`subfinder -d $TARGET -all -recursive`|5-10 min|
|**Multiple targets**|`subfinder -dL domains.txt -o results.txt`|varies|
|**API keys configured**|`subfinder -d $TARGET -all`|3-5 min|
|**Rate limited**|`subfinder -d $TARGET -sc 5 -delay 2`|10+ min|
|**Memory constrained**|Loop: `for d in $(cat domains.txt); do subfinder -d $d; done`|varies|

### Output Routing

|Next Step|Pipeline|
|---|---|
|DNS Resolution|`subfinder -d $TARGET -silent \| dnsx -a -silent`|
|HTTP Probing|`subfinder -d $TARGET -silent \| httpx -silent`|
|Port Scanning|`subfinder -d $TARGET -silent \| naabu -silent`|
|Save for later|`subfinder -d $TARGET -o $SCANDIR/$TARGET-subfinder-$DATE.txt`|

### Post-Processing Rules

- **ALWAYS** add `-nW` to remove wildcards
- **ALWAYS** dedupe with `sort -u` before next tool
- **ALWAYS** combine with Amass for completeness

---

## 2. AMASS â€” Advanced DNS Enumeration

**Purpose**: Comprehensive subdomain enumeration with OSINT intelligence. Slower but more thorough.

### When to Use: Amass vs Subfinder

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quick scan needed (< 5 min)?                                â”‚
â”‚ â†’ Use SUBFINDER only                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Comprehensive enumeration needed?                           â”‚
â”‚ â†’ Use BOTH Subfinder AND Amass                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Need organization intelligence (ASN, CIDR, related domains)?â”‚
â”‚ â†’ Use AMASS INTEL mode                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BEST PRACTICE: Always use both, merge results               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mode Selection Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Start Amass   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                   â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   ENUM    â”‚      â”‚   ENUM    â”‚      â”‚   INTEL   â”‚
   â”‚  Passive  â”‚      â”‚  Active   â”‚      â”‚  Gather   â”‚
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                  â”‚
         â–¼                  â–¼                  â–¼
   amass enum          amass enum         amass intel
   -passive            -active            -org "Name"
   -d $TARGET          -brute             -asn 12345
                       -d $TARGET         -cidr x.x.x.x/24
```

### Decision Matrix

|Scenario|Command|Time|
|---|---|---|
|**Passive only (stealth)**|`amass enum -passive -d $TARGET`|5-10 min|
|**Active enumeration**|`amass enum -active -d $TARGET`|15-30 min|
|**With brute force**|`amass enum -brute -d $TARGET -w wordlist.txt`|30-60 min|
|**Full reconnaissance**|`amass enum -active -brute -d $TARGET`|1-2 hr|
|**Organization intel**|`amass intel -org "Company Name"`|5-15 min|
|**ASN discovery**|`amass intel -asn 12345`|2-5 min|
|**CIDR enumeration**|`amass intel -cidr 192.168.0.0/16`|varies|
|**Slow network**|`amass enum -d $TARGET -max-dns-queries 500`|slower|
|**Fast network**|`amass enum -d $TARGET -max-dns-queries 2000`|faster|

### Integration Pattern

```bash
# Standard dual-tool enumeration
subfinder -d $TARGET -all -silent > $SCANDIR/$TARGET-subfinder-$DATE.txt
amass enum -passive -d $TARGET -o $SCANDIR/$TARGET-amass-$DATE.txt

# Merge and dedupe
cat $SCANDIR/$TARGET-subfinder-$DATE.txt \
    $SCANDIR/$TARGET-amass-$DATE.txt | sort -u > $SCANDIR/$TARGET-subs-merged-$DATE.txt

echo "Total unique subdomains: $(wc -l < $SCANDIR/$TARGET-subs-merged-$DATE.txt)"
```

---

## 3. DNSx â€” DNS Resolution & Validation

**Purpose**: Resolve subdomains to IPs, validate records, filter wildcards.

### Entry Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IF: Have subdomain list AND need IP resolution/validation   â”‚
â”‚ THEN: Use DNSx                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Record Type Selection Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Start DNSx    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   What records needed?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼          â–¼             â–¼             â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚  A    â”‚ â”‚ CNAME â”‚    â”‚  MX   â”‚    â”‚  NS   â”‚  â”‚  ALL  â”‚
â”‚(IPv4) â”‚ â”‚Takeoverâ”‚   â”‚(Mail) â”‚    â”‚(Name) â”‚  â”‚Recordsâ”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚         â”‚            â”‚            â”‚          â”‚
    â–¼         â–¼            â–¼            â–¼          â–¼
  -a       -cname        -mx          -ns      -a -aaaa
                                               -cname -mx
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**IPs only (common)**|`dnsx -l subs.txt -a -silent`|
|**IPv6 included**|`dnsx -l subs.txt -a -aaaa -silent`|
|**CNAME (takeover check)**|`dnsx -l subs.txt -cname -resp-only`|
|**Mail servers**|`dnsx -l subs.txt -mx -resp-only`|
|**Name servers**|`dnsx -l subs.txt -ns -resp-only`|
|**All records**|`dnsx -l subs.txt -a -aaaa -cname -ns -mx`|
|**Filter wildcards**|`dnsx -l subs.txt -a -wildcard`|
|**Filter by IP**|`dnsx -l subs.txt -a -resp '1.2.3.4'`|
|**Reverse lookup**|`dnsx -l ips.txt -ptr`|
|**Large list (stream)**|`dnsx -l subs.txt -a -c 200 -stream`|

### Subdomain Takeover Detection

```bash
# Find CNAMEs pointing to potentially vulnerable services
dnsx -l $SCANDIR/$TARGET-subs-merged-$DATE.txt -cname -resp-only | \
  grep -E "(github|s3|azure|heroku|cloudfront|shopify|fastly|pantheon|readme|surge)" \
  > $SCANDIR/$TARGET-takeover-candidates-$DATE.txt
```

### Standard Pipeline

```bash
# Resolve and save
dnsx -l $SCANDIR/$TARGET-subs-merged-$DATE.txt -a -silent \
  -o $SCANDIR/$TARGET-resolved-$DATE.txt

echo "Resolved: $(wc -l < $SCANDIR/$TARGET-resolved-$DATE.txt)"
```

---

## 4. NAABU â€” Fast Port Scanning

**Purpose**: Quick port discovery optimized for recon pipelines. Use for initial discovery.

### Tool Selection: Naabu vs Nmap

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Need quick port discovery for pipeline?                     â”‚
â”‚ â†’ Use NAABU (faster, better integration)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Need detailed service enumeration?                          â”‚
â”‚ â†’ Use NMAP after Naabu identifies open ports                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BEST PRACTICE: Naabu (discovery) â†’ Nmap (detail on open)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Permission-Based Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Running as root / sudo available?                           â”‚
â”‚ â†’ Use SYN scan: naabu -scan-type s (faster, stealthier)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ No root access?                                             â”‚
â”‚ â†’ Use CONNECT scan: naabu -scan-type c (works, slower)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Quick web ports**|`naabu -host $TARGET -p 80,443,8080,8443 -silent`|
|**Top 100 ports**|`naabu -host $TARGET -top-ports 100 -silent`|
|**Top 1000 ports**|`naabu -host $TARGET -top-ports 1000`|
|**All ports (slow)**|`naabu -host $TARGET -p - -rate 1000`|
|**SYN scan (root)**|`sudo naabu -host $TARGET -scan-type s`|
|**Connect scan (no root)**|`naabu -host $TARGET -scan-type c`|
|**UDP scan (root)**|`sudo naabu -host $TARGET -scan-type u -p 53,161,500`|
|**Fast network**|`naabu -host $TARGET -c 100 -rate 5000`|
|**IDS evasion**|`naabu -host $TARGET -rate 50 -scan-random-port`|
|**Skip CDN IPs**|`naabu -host $TARGET -exclude-cdn`|
|**From file**|`naabu -list hosts.txt -silent`|

### Standard Pipeline

```bash
# Quick discovery, then detailed nmap
naabu -list $SCANDIR/$TARGET-resolved-$DATE.txt -top-ports 100 -silent \
  -o $SCANDIR/$TARGET-naabu-$DATE.txt

# Extract unique IPs for nmap
cut -d: -f1 $SCANDIR/$TARGET-naabu-$DATE.txt | sort -u > $SCANDIR/$TARGET-live-ips-$DATE.txt

echo "Hosts with open ports: $(wc -l < $SCANDIR/$TARGET-live-ips-$DATE.txt)"
```

---

## 5. NMAP â€” Advanced Port & Service Scanning

**Purpose**: Detailed service enumeration, version detection, OS fingerprinting, NSE scripts.

### Scan Type Selection Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Start Nmap    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                   â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Quick   â”‚      â”‚ Standard  â”‚      â”‚  Stealth  â”‚
   â”‚   Scan    â”‚      â”‚   Scan    â”‚      â”‚   Scan    â”‚
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                  â”‚
         â–¼                  â–¼                  â–¼
    nmap -T4 -F       nmap -sV -sC       nmap -sS -T2
    $TARGET           $TARGET            $TARGET
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Quick TCP scan**|`nmap -T4 -F $TARGET`|
|**Full TCP scan**|`nmap -p- -T4 $TARGET`|
|**Service detection**|`nmap -sV $TARGET`|
|**OS detection**|`nmap -O $TARGET`|
|**Aggressive (full info)**|`nmap -A $TARGET`|
|**Default scripts**|`nmap -sC $TARGET`|
|**Version + scripts**|`nmap -sV -sC $TARGET`|
|**Stealth SYN**|`sudo nmap -sS -T2 $TARGET`|
|**UDP scan**|`sudo nmap -sU -p 53,67,161,500 $TARGET`|
|**Vulnerability scripts**|`nmap --script vuln $TARGET`|
|**Specific CVE**|`nmap --script http-vuln-cve2021-* $TARGET`|

### Timing Templates

|Flag|Name|Use Case|
|---|---|---|
|`-T0`|Paranoid|IDS evasion (very slow)|
|`-T1`|Sneaky|IDS evasion (slow)|
|`-T2`|Polite|Reduced load on target|
|`-T3`|Normal|Default, balanced|
|`-T4`|Aggressive|Fast, reliable networks|
|`-T5`|Insane|Very fast, may miss ports|

### Firewall Evasion

|Technique|Command|
|---|---|
|Fragment packets|`nmap -f $TARGET`|
|Decoy scan|`nmap -D RND:10 $TARGET`|
|Custom source port|`nmap --source-port 53 $TARGET`|
|Randomize hosts|`nmap --randomize-hosts $TARGET`|
|Append random data|`nmap --data-length 25 $TARGET`|
|Spoof MAC|`nmap --spoof-mac 0 $TARGET`|

### Standard Commands

```bash
# TCP scan with service detection
sudo nmap -T3 -Pn -sS -sV --min-rate 1000 \
  -iL $SCANDIR/$TARGET-live-ips-$DATE.txt \
  -oX $SCANDIR/$TARGET-nmap-tcp-$DATE.xml \
  -oN $SCANDIR/$TARGET-nmap-tcp-$DATE.txt

# UDP scan (common services)
sudo nmap -T3 -Pn -sU -p 53,67,68,69,88,123,135,137,138,139,161,162,389,500,514,520,623,1900 \
  --min-rate 500 \
  -iL $SCANDIR/$TARGET-live-ips-$DATE.txt \
  -oX $SCANDIR/$TARGET-nmap-udp-$DATE.xml \
  -oN $SCANDIR/$TARGET-nmap-udp-$DATE.txt

# Count results
echo "Open TCP: $(grep -c 'open' $SCANDIR/$TARGET-nmap-tcp-$DATE.txt)"
echo "Open UDP: $(grep -c 'open' $SCANDIR/$TARGET-nmap-udp-$DATE.txt)"
```

---

## 6. HTTPX â€” HTTP Probing & Tech Detection

**Purpose**: Identify live HTTP services, detect technologies, capture metadata. Bridge between discovery and vuln scanning.

### Entry Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IF: Have list of hosts/subdomains/IPs                       â”‚
â”‚ THEN: Use HTTPX to identify live web services               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Information Level Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Start HTTPX   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
            What information needed?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼            â–¼           â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ Basic â”‚  â”‚Status â”‚   â”‚ Tech  â”‚   â”‚ Full  â”‚   â”‚Screen â”‚
â”‚ Probe â”‚  â”‚+Title â”‚   â”‚Detect â”‚   â”‚ Meta  â”‚   â”‚ shots â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚          â”‚           â”‚           â”‚           â”‚
    â–¼          â–¼           â–¼           â–¼           â–¼
 -silent   -status-code  -tech-    -status-code  -screenshot
           -title        detect    -title
                                   -tech-detect
                                   -server
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Basic probe**|`httpx -l hosts.txt -silent`|
|**With status codes**|`httpx -l hosts.txt -status-code`|
|**With titles**|`httpx -l hosts.txt -title`|
|**Tech detection**|`httpx -l hosts.txt -tech-detect`|
|**Full metadata**|`httpx -l hosts.txt -status-code -title -tech-detect -server`|
|**Screenshots**|`httpx -l hosts.txt -screenshot`|
|**Only 200 OK**|`httpx -l hosts.txt -mc 200`|
|**Exclude 404/403**|`httpx -l hosts.txt -fc 404,403`|
|**Match tech**|`httpx -l hosts.txt -tech-detect -match-tech wordpress`|
|**Custom ports**|`httpx -l hosts.txt -ports 80,443,8080,8443`|
|**Large list**|`httpx -l hosts.txt -c 100 -stream`|
|**Rate limited**|`httpx -l hosts.txt -c 10 -timeout 15 -delay 2s`|

### Standard Pipeline

```bash
# Full probe with metadata
httpx -l $SCANDIR/$TARGET-resolved-$DATE.txt \
  -status-code -title -tech-detect -server -silent \
  -o $SCANDIR/$TARGET-httpx-$DATE.txt

# Extract URLs for further scanning
cut -d' ' -f1 $SCANDIR/$TARGET-httpx-$DATE.txt > $SCANDIR/$TARGET-live-urls-$DATE.txt

echo "Live HTTP hosts: $(wc -l < $SCANDIR/$TARGET-live-urls-$DATE.txt)"
```

---

## 7. KATANA â€” Web Crawling

**Purpose**: Intelligent web crawling to discover endpoints, paths, JavaScript files, hidden functionality.

### Tool Selection: Katana vs Gobuster/FFUF

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Need to discover endpoints via crawling?                    â”‚
â”‚ â†’ Use KATANA (intelligent, follows links)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Need directory/file brute-forcing?                          â”‚
â”‚ â†’ Use GOBUSTER or FFUF                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BEST PRACTICE: Passive (wayback/gau) â†’ Katana â†’ Gobuster    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Crawler Mode Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Start Katana   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
               What crawling method?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼            â–¼           â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP  â”‚  â”‚  JS   â”‚   â”‚Sitemapâ”‚   â”‚Robots â”‚   â”‚  ALL  â”‚
â”‚ Crawl â”‚  â”‚ Parse â”‚   â”‚ Based â”‚   â”‚ Based â”‚   â”‚Methodsâ”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚          â”‚           â”‚           â”‚           â”‚
    â–¼          â–¼           â–¼           â–¼           â–¼
-crawler    -js-crawl   -crawler    -crawler   -crawler
standard                sitemap     robots     standard,js,
                                               sitemap,robots
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Standard crawl**|`katana -u https://$TARGET -crawler standard`|
|**JavaScript parsing**|`katana -u https://$TARGET -js-crawl`|
|**Sitemap-based**|`katana -u https://$TARGET -crawler sitemap`|
|**All methods**|`katana -u https://$TARGET -crawler standard,js,sitemap,robots`|
|**Shallow (quick)**|`katana -u https://$TARGET -depth 1`|
|**Deep crawl**|`katana -u https://$TARGET -depth 5`|
|**Same domain only**|`katana -u https://$TARGET -crawl-scope strict`|
|**Include subdomains**|`katana -u https://$TARGET -crawl-scope subs`|
|**JavaScript files**|`katana -u https://$TARGET -extension js`|
|**Exclude images**|`katana -u https://$TARGET -exclude-extension png,jpg,gif,css`|
|**With forms**|`katana -u https://$TARGET -form-fill`|
|**Rate limited**|`katana -u https://$TARGET -concurrency 5 -delay 500`|

### Standard Pipeline

```bash
# Passive first (no target load)
echo $TARGET | waybackurls > $SCANDIR/$TARGET-wayback-$DATE.txt
echo $TARGET | gau --ft "\.jpg$|\.png$|\.gif$|\.css$" > $SCANDIR/$TARGET-gau-$DATE.txt

# Active crawling
katana -u https://$TARGET -silent -depth 3 \
  -exclude-extension png,jpg,gif,css,woff,woff2,ttf \
  -o $SCANDIR/$TARGET-katana-$DATE.txt

# Combine passive + active
cat $SCANDIR/$TARGET-wayback-$DATE.txt \
    $SCANDIR/$TARGET-gau-$DATE.txt \
    $SCANDIR/$TARGET-katana-$DATE.txt | sort -u > $SCANDIR/$TARGET-urls-all-$DATE.txt

echo "URLs discovered: $(wc -l < $SCANDIR/$TARGET-urls-all-$DATE.txt)"
```

---

## 8. GOBUSTER â€” Directory Brute-forcing

**Purpose**: Discover hidden directories, files, and paths via wordlist brute-forcing.

### Mode Selection Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Start Gobuster  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   What to brute-force?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼            â–¼           â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚  DIR  â”‚  â”‚  DNS  â”‚   â”‚ VHOST â”‚   â”‚  S3   â”‚   â”‚ FUZZ  â”‚
â”‚ Mode  â”‚  â”‚ Mode  â”‚   â”‚ Mode  â”‚   â”‚Bucketsâ”‚   â”‚ Mode  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚          â”‚           â”‚           â”‚           â”‚
    â–¼          â–¼           â–¼           â–¼           â–¼
gobuster    gobuster    gobuster    gobuster   gobuster
dir         dns         vhost       s3         fuzz
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Directory enumeration**|`gobuster dir -u https://$TARGET -w wordlist.txt`|
|**DNS subdomain**|`gobuster dns -d $TARGET -w wordlist.txt`|
|**Virtual host**|`gobuster vhost -u https://$TARGET -w wordlist.txt`|
|**S3 buckets**|`gobuster s3 -w bucket-names.txt`|
|**PHP app**|`gobuster dir -u $URL -w list.txt -x php,php5,phtml`|
|**ASP.NET**|`gobuster dir -u $URL -w list.txt -x asp,aspx,ashx`|
|**Java**|`gobuster dir -u $URL -w list.txt -x jsp,jsf,do,action`|
|**Backup files**|`gobuster dir -u $URL -w list.txt -x bak,old,backup,~,swp`|
|**Config files**|`gobuster dir -u $URL -w list.txt -x xml,conf,config,ini,env`|
|**Hide 404**|`gobuster dir -u $URL -w list.txt -b 404`|
|**Hide 403+404**|`gobuster dir -u $URL -w list.txt -b 404,403`|
|**Faster**|`gobuster dir -u $URL -w list.txt -t 50`|
|**Rate limited**|`gobuster dir -u $URL -w list.txt -t 5 --delay 100ms`|

### Wordlist Strategy (CRITICAL)

|Wordlist|Size|Time|Use Case|
|---|---|---|---|
|`common.txt`|~5K|2-3 min|Quick baseline, always run|
|`directory-list-2.3-medium.txt`|~220K|15-20 min|Comprehensive, recommended|
|`directory-list-2.3-big.txt`|~500K+|1+ hr|**AVOID** - diminishing returns|
|`web-extensions.txt`|~100|<1 min|Add file extensions|
|`api-endpoints.txt`|~1K|2-3 min|API discovery|

**Decision Rule**:

```
ALWAYS run: common.txt (quick baseline)
USUALLY run: directory-list-2.3-medium.txt (good coverage)
RARELY run: big.txt (only if medium found interesting patterns)
TIME BUDGET: ~25-30 min total for directory enumeration
```

### Standard Pipeline

```bash
# Quick baseline
gobuster dir -u https://$TARGET \
  -w /usr/share/seclists/Discovery/Web-Content/common.txt \
  -o $SCANDIR/$TARGET-gobuster-common-$DATE.txt -q --no-error

# Comprehensive (if time permits)
gobuster dir -u https://$TARGET \
  -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt \
  -o $SCANDIR/$TARGET-gobuster-medium-$DATE.txt -q --no-error

# Merge results
cat $SCANDIR/$TARGET-gobuster-*.txt | sort -u > $SCANDIR/$TARGET-dirs-merged-$DATE.txt

echo "Directories found: $(wc -l < $SCANDIR/$TARGET-dirs-merged-$DATE.txt)"
```

---

## 9. FFUF â€” Flexible Fuzzing

**Purpose**: Advanced fuzzing for directories, parameters, headers, and more. More flexible than Gobuster.

### When to Use: FFUF vs Gobuster

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Simple directory brute-forcing?                             â”‚
â”‚ â†’ Use GOBUSTER (simpler, faster for basic tasks)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Need parameter fuzzing, header fuzzing, or complex patterns?â”‚
â”‚ â†’ Use FFUF (more flexible and powerful)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Need to fuzz POST data or JSON bodies?                      â”‚
â”‚ â†’ Use FFUF                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Fuzzing Mode Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Start FFUF    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   What to fuzz?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼          â–¼             â–¼             â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚  DIR  â”‚ â”‚ PARAM â”‚    â”‚ VALUE â”‚    â”‚HEADER â”‚  â”‚ POST  â”‚
â”‚ Path  â”‚ â”‚ Name  â”‚    â”‚Fuzzingâ”‚    â”‚Fuzzingâ”‚  â”‚ Data  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚         â”‚            â”‚            â”‚          â”‚
    â–¼         â–¼            â–¼            â–¼          â–¼
/FUZZ     ?FUZZ=x      ?id=FUZZ    -H "X:FUZZ"  -d "x=FUZZ"
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Directory fuzzing**|`ffuf -u https://$TARGET/FUZZ -w wordlist.txt`|
|**Parameter name**|`ffuf -u https://$TARGET?FUZZ=test -w params.txt`|
|**Parameter value**|`ffuf -u https://$TARGET?id=FUZZ -w values.txt`|
|**Header fuzzing**|`ffuf -u https://$TARGET -H 'X-Custom: FUZZ' -w wordlist.txt`|
|**POST data**|`ffuf -u $URL -X POST -d 'user=FUZZ' -w wordlist.txt`|
|**JSON body**|`ffuf -u $URL -X POST -H 'Content-Type: application/json' -d '{"id":"FUZZ"}' -w values.txt`|
|**Multi-position**|`ffuf -u https://$TARGET/FUZZ1/FUZZ2 -w w1:FUZZ1 -w w2:FUZZ2`|
|**Match status**|`ffuf -u $URL/FUZZ -w list.txt -mc 200,301,302`|
|**Filter status**|`ffuf -u $URL/FUZZ -w list.txt -fc 404,403`|
|**Filter size**|`ffuf -u $URL/FUZZ -w list.txt -fs 0`|
|**Filter words**|`ffuf -u $URL/FUZZ -w list.txt -fw 10`|
|**Rate limited**|`ffuf -u $URL/FUZZ -w list.txt -t 10 -rate 50`|
|**Silent mode**|`ffuf -u $URL/FUZZ -w list.txt -s`|

### Standard Pipeline

```bash
# API endpoint discovery
ffuf -u https://$TARGET/FUZZ \
  -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt \
  -mc 200,201,301,302,401,403 \
  -o $SCANDIR/$TARGET-ffuf-api-$DATE.json -of json -s

# Parameter fuzzing (common params)
ffuf -u "https://$TARGET?FUZZ=test" \
  -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt \
  -mc 200 -fs 0 \
  -o $SCANDIR/$TARGET-ffuf-params-$DATE.json -of json -s
```

---

## 10. WHATWEB â€” Technology Fingerprinting

**Purpose**: Identify web technologies, CMS, frameworks, servers.

### Aggression Level Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Start WhatWeb  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   Stealth requirement?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼            â–¼           â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stealthyâ”‚ â”‚Standardâ”‚  â”‚Aggressiveâ”‚ â”‚ Heavy â”‚   â”‚Passiveâ”‚
â”‚ Level 1â”‚  â”‚Level 2 â”‚  â”‚ Level 3 â”‚  â”‚Level 4â”‚   â”‚ Only  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚          â”‚           â”‚           â”‚           â”‚
    â–¼          â–¼           â–¼           â–¼           â–¼
  -a 1       -a 2        -a 3        -a 4      httpx
 (passive)  (default)   (active)   (noisy)   -tech-detect
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Passive (stealth)**|`whatweb -a 1 https://$TARGET`|
|**Standard**|`whatweb -a 2 https://$TARGET` (default)|
|**Aggressive**|`whatweb -a 3 https://$TARGET`|
|**Heavy (noisy)**|`whatweb -a 4 https://$TARGET`|
|**From file**|`whatweb -i urls.txt`|
|**Brief output**|`whatweb --log-brief brief.txt https://$TARGET`|
|**JSON output**|`whatweb --log-json results.json https://$TARGET`|
|**Verbose**|`whatweb -v https://$TARGET`|

### Standard Pipeline

```bash
# Fingerprint all live hosts
whatweb -i $SCANDIR/$TARGET-live-urls-$DATE.txt \
  --log-brief $SCANDIR/$TARGET-whatweb-$DATE.txt

# WAF detection
wafw00f -i $SCANDIR/$TARGET-live-urls-$DATE.txt \
  -o $SCANDIR/$TARGET-wafw00f-$DATE.txt

# SSL/TLS analysis (if HTTPS)
grep "https://" $SCANDIR/$TARGET-live-urls-$DATE.txt | while read url; do
  sslscan --no-failed "$url" >> $SCANDIR/$TARGET-sslscan-$DATE.txt 2>/dev/null
done
```

---

## 11. NUCLEI â€” Vulnerability Scanning

**Purpose**: Template-based vulnerability detection. Primary tool for identifying security issues.

### Entry Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IF: Have list of live HTTP endpoints                        â”‚
â”‚ THEN: Use Nuclei for vulnerability detection                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ First time scanning target?                                 â”‚
â”‚ â†’ Start with discovery templates, then escalate             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Template Selection Tree

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Start Nuclei   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
               What type of scan?
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼            â–¼           â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quick â”‚  â”‚  CVE  â”‚   â”‚Misconfigâ”‚  â”‚ Tech  â”‚   â”‚  Full â”‚
â”‚ Disco â”‚  â”‚ Scan  â”‚   â”‚  Scan  â”‚   â”‚Specificâ”‚  â”‚ Scan  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚          â”‚           â”‚           â”‚           â”‚
    â–¼          â–¼           â–¼           â–¼           â–¼
-tags       -tags        -tags      -t tech/    -tags cve,
tech,       cve          misconfig  wordpress/  misconfig,
exposure                            jira/       exposure
```

### Decision Matrix

|Scenario|Command|
|---|---|
|**Quick discovery**|`nuclei -l urls.txt -tags tech,exposure`|
|**CVE scanning**|`nuclei -l urls.txt -tags cve`|
|**Misconfigurations**|`nuclei -l urls.txt -tags misconfig`|
|**Full security scan**|`nuclei -l urls.txt -tags cve,misconfig,exposure`|
|**Tech-specific**|`nuclei -l urls.txt -t wordpress/`|
|**Critical only**|`nuclei -l urls.txt -severity critical`|
|**High + Critical**|`nuclei -l urls.txt -severity high,critical`|
|**Exclude info/low**|`nuclei -l urls.txt -exclude-severity info,low`|
|**Aggressive**|`nuclei -l urls.txt -c 50 -rate-limit 300`|
|**Careful (WAF)**|`nuclei -l urls.txt -c 10 -rate-limit 30`|
|**OOB testing**|`nuclei -l urls.txt -interactsh-server https://oast.me`|
|**Headless**|`nuclei -l urls.txt -headless`|
|**JSON output**|`nuclei -l urls.txt -j -o results.json`|

### Standard Pipeline

```bash
# Discovery + CVE + Misconfig (medium+ severity)
nuclei -l $SCANDIR/$TARGET-live-urls-$DATE.txt \
  -t ~/nuclei-templates/ \
  -tags discovery,cve,misconfig,exposure \
  -severity medium,high,critical \
  -silent \
  -o $SCANDIR/$TARGET-nuclei-$DATE.txt

# Count by severity
echo "Critical: $(grep -c '\[critical\]' $SCANDIR/$TARGET-nuclei-$DATE.txt)"
echo "High:     $(grep -c '\[high\]' $SCANDIR/$TARGET-nuclei-$DATE.txt)"
echo "Medium:   $(grep -c '\[medium\]' $SCANDIR/$TARGET-nuclei-$DATE.txt)"
```

### CRITICAL Finding Protocol

**IMMEDIATE notification for CRITICAL/HIGH findings:**

```
ğŸš¨ CRITICAL | [CVE-XXXX-XXXX] | Host: [host] | [brief description]
Awaiting operator action before proceeding.
```

---

## 12. NIKTO â€” Web Server Scanning

**Purpose**: Comprehensive web server scanner for dangerous files, outdated servers, misconfigurations.

### Entry Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Need comprehensive web server security check?               â”‚
â”‚ â†’ Use NIKTO (thorough but slow and noisy)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Stealth required?                                           â”‚
â”‚ â†’ AVOID Nikto (very noisy, easily detected)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tuning Reference

|Tuning|Description|Risk|
|---|---|---|
|1|Interesting files (logs, backups)|Low|
|2|Misconfiguration (default files)|Low|
|3|Information disclosure|Low|
|4|XSS/Script injection points|Medium|
|5|Remote file retrieval (includes)|Medium|
|6|DoS tests|**AVOID**|
|7|Remote shell / Command exec|Medium|
|8|SQL injection|Medium|
|9|File upload vulnerabilities|Medium|
|b|Software identification|Low|
|c|Remote source inclusion|Medium|
|d|WebService vulnerabilities|Medium|

### Decision Matrix

|Scenario|Command|
|---|---|
|**Full scan (recommended)**|`nikto -h https://$TARGET -Tuning 123457890bcd`|
|**Quick scan**|`nikto -h https://$TARGET -Tuning 123`|
|**Info disclosure only**|`nikto -h https://$TARGET -Tuning 3`|
|**SSL checks**|`nikto -h https://$TARGET -Tuning 7`|
|**HTML report**|`nikto -h https://$TARGET -o report.html -Format html`|
|**With proxy**|`nikto -h https://$TARGET -useproxy http://127.0.0.1:8080`|
|**Time limited**|`nikto -h https://$TARGET -maxtime 300`|
|**Rate limited**|`nikto -h https://$TARGET -Pause 2`|

### Standard Pipeline

```bash
# Full scan with HTML report (avoid DoS tuning 6)
nikto -h $SCANDIR/$TARGET-live-urls-$DATE.txt \
  -Tuning 123457890bcd \
  -o $SCANDIR/$TARGET-nikto-$DATE.html -Format html

echo "Nikto scan complete: $SCANDIR/$TARGET-nikto-$DATE.html"
```

---

# PHASE EXECUTION

## Phase 1 â€” Passive OSINT

**Goal**: Gather intelligence without touching the target. **Time**: 10-15 min

```bash
# Whois & DNS
whois $TARGET > $SCANDIR/$TARGET-whois-$DATE.txt
dig $TARGET ANY > $SCANDIR/$TARGET-dig-$DATE.txt
dnsrecon -d $TARGET -t std > $SCANDIR/$TARGET-dnsrecon-$DATE.txt

# OSINT sources
theHarvester -d $TARGET -l 500 -b all > $SCANDIR/$TARGET-harvester-$DATE.txt
shodan search hostname:$TARGET > $SCANDIR/$TARGET-shodan-$DATE.txt 2>/dev/null

# Summary
EMAILS=$(grep -c "@" $SCANDIR/$TARGET-harvester-$DATE.txt 2>/dev/null || echo 0)
echo "Phase 1 complete: $EMAILS emails found"
```

**Telegram**: `Phase 1 OSINT | Emails: N | IPs: N | Notable: [finding] | â†’ Phase 2`

---

## Phase 2 â€” Subdomain Enumeration

**Goal**: Build comprehensive subdomain list. **Time**: 15-30 min

```bash
# Passive enumeration (both tools)
subfinder -d $TARGET -all -silent > $SCANDIR/$TARGET-subfinder-$DATE.txt
amass enum -passive -d $TARGET -o $SCANDIR/$TARGET-amass-$DATE.txt

# Merge and dedupe
cat $SCANDIR/$TARGET-subfinder-$DATE.txt \
    $SCANDIR/$TARGET-amass-$DATE.txt | sort -u > $SCANDIR/$TARGET-subs-merged-$DATE.txt

# Resolve
dnsx -l $SCANDIR/$TARGET-subs-merged-$DATE.txt -a -silent \
  -o $SCANDIR/$TARGET-resolved-$DATE.txt

FOUND=$(wc -l < $SCANDIR/$TARGET-subs-merged-$DATE.txt)
RESOLVED=$(wc -l < $SCANDIR/$TARGET-resolved-$DATE.txt)
echo "Phase 2 complete: $FOUND found, $RESOLVED resolved"
```

**Telegram**: `Phase 2 Subs | Found: N | Resolved: N | Notable: [interesting] | â†’ Phase 3`

---

## Phase 3 â€” Live Host Discovery

**Goal**: Identify live HTTP/HTTPS services. **Time**: 5-15 min

```bash
# HTTP probe with metadata
httpx -l $SCANDIR/$TARGET-resolved-$DATE.txt \
  -status-code -title -tech-detect -server -silent \
  -o $SCANDIR/$TARGET-httpx-$DATE.txt

# Extract URLs
cut -d' ' -f1 $SCANDIR/$TARGET-httpx-$DATE.txt > $SCANDIR/$TARGET-live-urls-$DATE.txt

LIVE=$(wc -l < $SCANDIR/$TARGET-live-urls-$DATE.txt)
echo "Phase 3 complete: $LIVE live hosts"
```

**Telegram**: `Phase 3 Live | HTTP: N alive | Notable: [403s, admin] | â†’ Phase 4`

---

## Phase 4 â€” Port Scanning

**Goal**: Comprehensive service discovery. **Time**: 20-45 min

```bash
# Extract IPs
grep -oP '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}' $SCANDIR/$TARGET-httpx-$DATE.txt | \
  sort -u > $SCANDIR/$TARGET-live-ips-$DATE.txt

# TCP scan
sudo nmap -T3 -Pn -sS -sV --min-rate 1000 \
  -iL $SCANDIR/$TARGET-live-ips-$DATE.txt \
  -oX $SCANDIR/$TARGET-nmap-tcp-$DATE.xml \
  -oN $SCANDIR/$TARGET-nmap-tcp-$DATE.txt

# UDP scan (common)
sudo nmap -T3 -Pn -sU -p 53,67,123,161,500,514,1900 --min-rate 500 \
  -iL $SCANDIR/$TARGET-live-ips-$DATE.txt \
  -oN $SCANDIR/$TARGET-nmap-udp-$DATE.txt

TCP=$(grep -c 'open' $SCANDIR/$TARGET-nmap-tcp-$DATE.txt 2>/dev/null || echo 0)
echo "Phase 4 complete: $TCP open TCP ports"
```

**Telegram**: `Phase 4 Ports | TCP: N open | Services: [list] | â†’ Phase 5`

---

## Phase 5 â€” Fingerprinting

**Goal**: Identify technologies, CMS, WAF, SSL issues. **Time**: 10-20 min

```bash
# Technology fingerprinting
whatweb -i $SCANDIR/$TARGET-live-urls-$DATE.txt \
  --log-brief $SCANDIR/$TARGET-whatweb-$DATE.txt

# WAF detection
wafw00f -i $SCANDIR/$TARGET-live-urls-$DATE.txt \
  -o $SCANDIR/$TARGET-wafw00f-$DATE.txt 2>/dev/null

# SSL analysis
grep "https://" $SCANDIR/$TARGET-live-urls-$DATE.txt | head -10 | while read url; do
  sslscan --no-failed "$url" >> $SCANDIR/$TARGET-sslscan-$DATE.txt 2>/dev/null
done

echo "Phase 5 complete: Fingerprinting done"
```

**Telegram**: `Phase 5 FP | CMS: [list] | WAF: [yes/no] | SSL issues: N | â†’ Phase 6`

---

## Phase 6 â€” URL & Path Discovery

**Goal**: Map endpoints, APIs, hidden paths. **Time**: 30-45 min

```bash
# Passive (no target load)
echo $TARGET | waybackurls > $SCANDIR/$TARGET-wayback-$DATE.txt 2>/dev/null
echo $TARGET | gau --ft "\.jpg$|\.png$|\.gif$|\.css$" > $SCANDIR/$TARGET-gau-$DATE.txt 2>/dev/null

# Active crawling
katana -u https://$TARGET -silent -depth 3 \
  -exclude-extension png,jpg,gif,css,woff,woff2 \
  -o $SCANDIR/$TARGET-katana-$DATE.txt

# Directory brute-force (balanced wordlists)
gobuster dir -u https://$TARGET \
  -w /usr/share/seclists/Discovery/Web-Content/common.txt \
  -o $SCANDIR/$TARGET-gobuster-common-$DATE.txt -q --no-error

gobuster dir -u https://$TARGET \
  -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt \
  -o $SCANDIR/$TARGET-gobuster-medium-$DATE.txt -q --no-error

# API discovery
ffuf -u https://$TARGET/FUZZ \
  -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt \
  -mc 200,201,301,302,401,403 \
  -o $SCANDIR/$TARGET-ffuf-api-$DATE.json -of json -s

# Merge all
cat $SCANDIR/$TARGET-wayback-$DATE.txt \
    $SCANDIR/$TARGET-gau-$DATE.txt \
    $SCANDIR/$TARGET-katana-$DATE.txt \
    $SCANDIR/$TARGET-gobuster-*.txt 2>/dev/null | sort -u > $SCANDIR/$TARGET-paths-all-$DATE.txt

PATHS=$(wc -l < $SCANDIR/$TARGET-paths-all-$DATE.txt)
echo "Phase 6 complete: $PATHS paths discovered"
```

**Telegram**: `Phase 6 URLs | Wayback: N | Dirs: N | Notable: [/admin, /api] | â†’ Phase 7`

---

## Phase 7 â€” Vulnerability Scanning

**Goal**: Identify CVEs and misconfigurations. **NO EXPLOITATION.** **Time**: 30-60 min

```bash
# Nuclei scan (medium+ severity)
nuclei -l $SCANDIR/$TARGET-live-urls-$DATE.txt \
  -t ~/nuclei-templates/ \
  -tags discovery,cve,misconfig,exposure \
  -severity medium,high,critical \
  -silent \
  -o $SCANDIR/$TARGET-nuclei-$DATE.txt

# Nikto scan (skip DoS)
nikto -h https://$TARGET \
  -Tuning 123457890bcd \
  -o $SCANDIR/$TARGET-nikto-$DATE.html -Format html

# Count findings
CRIT=$(grep -c '\[critical\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)
HIGH=$(grep -c '\[high\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)
MED=$(grep -c '\[medium\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)

echo "Phase 7 complete: $CRIT critical, $HIGH high, $MED medium"

# CRITICAL ALERT (if any)
if [ "$CRIT" -gt 0 ] || [ "$HIGH" -gt 0 ]; then
  echo "ğŸš¨ CRITICAL/HIGH findings detected - notify operator immediately!"
fi
```

**Telegram**: `Phase 7 Vulns | Critical: N | High: N | Medium: N | â†’ Phase 8`

**CRITICAL FINDING**: Notify immediately, don't wait!

---

## Phase 8 â€” Report Generation

**Goal**: Generate professional PDF report with findings. **Time**: 5-10 min **Skill**: Read `/mnt/skills/public/pdf/SKILL.md` for PDF generation methods.

### Report Requirements

|Section|Content|
|---|---|
|Executive Summary|Target, date, operator, key metrics|
|Findings Summary|Counts by severity (critical/high/medium)|
|Critical Findings|Full details of critical vulnerabilities|
|High Findings|Full details of high vulnerabilities|
|Phase Results|Summary table of all 7 phases|
|Scan Files|List of output files and locations|

### Data Collection

```bash
# Gather metrics for report
SUBS_FOUND=$(wc -l < $SCANDIR/$TARGET-subs-merged-$DATE.txt 2>/dev/null || echo 0)
SUBS_RESOLVED=$(wc -l < $SCANDIR/$TARGET-resolved-$DATE.txt 2>/dev/null || echo 0)
LIVE_HOSTS=$(wc -l < $SCANDIR/$TARGET-live-urls-$DATE.txt 2>/dev/null || echo 0)
OPEN_PORTS=$(grep -c 'open' $SCANDIR/$TARGET-nmap-tcp-$DATE.txt 2>/dev/null || echo 0)
CRITICAL=$(grep -c '\[critical\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)
HIGH=$(grep -c '\[high\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)
MEDIUM=$(grep -c '\[medium\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)

# Critical/High finding details
grep '\[critical\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null > /tmp/critical_findings.txt
grep '\[high\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null > /tmp/high_findings.txt
```

### Generate PDF

Use the pdf skill to create a professional report:

1. Read `/mnt/skills/public/pdf/SKILL.md`
2. Use **reportlab** or **weasyprint** (HTMLâ†’PDF) method
3. Include all sections listed above
4. Save to: `$REPORTDIR/$TARGET-summary-$DATE.pdf`

```bash
echo "PDF Report: $REPORTDIR/$TARGET-summary-$DATE.pdf"
```

---

## Phase 9 â€” Operator Notification

**Goal**: Final summary to operator.

```bash
ELAPSED=$(( ($(date +%s) - START) / 60 ))

echo "
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EagleEye â€” Recon Complete
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Target: $TARGET
Date: $DATE
Duration: ${ELAPSED} minutes

Results:
â€¢ Subdomains: $(wc -l < $SCANDIR/$TARGET-resolved-$DATE.txt 2>/dev/null || echo 0) resolved
â€¢ Live hosts: $(wc -l < $SCANDIR/$TARGET-live-urls-$DATE.txt 2>/dev/null || echo 0) online
â€¢ Open ports: $(grep -c 'open' $SCANDIR/$TARGET-nmap-tcp-$DATE.txt 2>/dev/null || echo 0) TCP
â€¢ Critical: $(grep -c '\[critical\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)
â€¢ High: $(grep -c '\[high\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)
â€¢ Medium: $(grep -c '\[medium\]' $SCANDIR/$TARGET-nuclei-$DATE.txt 2>/dev/null || echo 0)

Report: $REPORTDIR/$TARGET-summary-$DATE.pdf
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"
```

---

# QUICK REFERENCE

## Tool Selection Matrix

|Phase|Primary|Alternative|When to Use Alternative|
|---|---|---|---|
|Subdomain Enum|Subfinder|Amass|Need comprehensive/intel|
|DNS Resolution|DNSx|dig/host|Single queries|
|Port Discovery|Naabu|Nmap|Need service detection|
|Service Detection|Nmap -sV|Naabu -sv|Quick check only|
|HTTP Probing|HTTPX|curl|Single URL testing|
|Tech Detection|HTTPX/WhatWeb|-|Use both|
|Web Crawling|Katana|hakrawler|Simpler needs|
|Dir Brute-force|Gobuster|FFUF|Need param fuzzing|
|Vuln Scanning|Nuclei|Nikto|Web server focus|

## Time Budget Guide

|Budget|Approach|Phases|
|---|---|---|
|< 30 min|`subfinder \| httpx \| nuclei -tags tech`|2,3,7 only|
|< 2 hours|Passive + httpx + naabu + nuclei|1-4, 7|
|5+ hours|Complete 9-phase methodology|All phases|

## Stealth Levels

|Level|Tools|Noise|
|---|---|---|
|Maximum stealth|subfinder, amass -passive, waybackurls|None|
|Low noise|httpx, katana -depth 1|Minimal|
|Normal|naabu, gobuster -t 10|Moderate|
|Aggressive|nmap -A, nikto, gobuster -t 50|High|